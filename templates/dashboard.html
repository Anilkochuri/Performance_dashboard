
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Performance Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
    <h1>Welcome to the Performance Dashboard</h1>

    <form method="POST" action="{{ url_for('dashboard') }}" enctype="multipart/form-data">
        <label for="file">Upload CSV File:</label>
        <input type="file" name="file" id="file" required>
        <button type="submit">Upload</button>
    </form>

    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <ul class="flashes">
          {% for message in messages %}
            <li>{{ message }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    {% endwith %}

    {% if table_html %}
        <h2>Data Table</h2>
        <div>{{ table_html|safe }}</div>
    {% endif %}

    {% if chart_json %}
        <h2>Chart</h2>
        <div id="plotly-chart"></div>
        <script>
            var chartData = {{ chart_json|safe }};
            Plotly.newPlot('plotly-chart', chartData.data, chartData.layout);
        </script>
    {% elif chart_png %}
        <h2>Chart</h2>
        <img src="{{ url_for('static', filename=chart_png) }}" alt="Chart Image">
    {% endif %}

    <div class="export-buttons">
        <h2>Export Options</h2>
        <a href="{{ url_for('export_excel') }}">Export to Excel</a> |
        <a href="{{ url_for('export_csv') }}">Export to CSV</a> |
        <a href="{{ url_for('export_word') }}">Export to Word</a>
    </div>

    <div class="logout">
        <a href="{{ url_for('logout') }}">Logout</a>
    </div>
</body>
</html>
